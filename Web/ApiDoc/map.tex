\section{Map web service}
\label{sec:call:map}

This section describes the calls required to pull garbage tags and charted areas
out of the system. These are implemented in the
\svnweb{ro/ldir/map/MapWebService}{ro.ldir.map.MapWebService} web resource. The
calls are mostly designed to serve as input for a mapping service, e.g., Google
Maps. Therefore, most of these calls output a KML and are performed in
anonymous fashion (no authentication is necessary). Some of these calls may
output a XML / JSON, according to the ``Accept'' headers that clients specify
in a call.

\subsection{Obtaining the garbage groups in a bounding box}

\apilocation{get}{map/ws/garbagegroups/?topLeftX=\param{topLeftX}\&\\topLeftY=\param{topLeftY}\&bottomRightX=\param{bottomRightX}\&bottomRightY=\param{bottomRightY}\&\\cb=\param{callback\_url}}
\begin{apidata}{parameters}
  \begin{datalist}
    \replyditem{\texttt{callback\_url} a pattern inserted in the KML description
    where \texttt{\{\{\{ID\}\}\}} is replaced with the entity ID.}
  \end{datalist}
\end{apidata}
\begin{apidata}{returns}
  \begin{datalist}
    \replyditem{A KML of all the garbages in the bounding box.}
  \end{datalist}
\end{apidata}


\subsection{Obtaining the garbage tags in a bounding box}

\apilocation{get}{map/ws/garbages/?topLeftX=\param{topLeftX}\&\\topLeftY=\param{topLeftY}\&bottomRightX=\param{bottomRightX}\&bottomRightY=\param{bottomRightY}\&\\cb=\param{callback\_url}\&maxResults=\param{maxResults}}
\begin{apidata}{parameters}
  \begin{datalist}
    \replyditem{\texttt{callback\_url} a pattern inserted in the KML description
    where \texttt{\{\{\{ID\}\}\}} is replaced with the entity ID. This parameter
    is valid only when requesting a XML.}
    \replyditem{\texttt{maxResults} the maximum number of results to be
    returned, when asking for a XML or JSON.}
  \end{datalist}
\end{apidata}
\begin{apidata}{returns}
  \begin{datalist}
    \replyditem{A KML/XML/JSON of all the garbages in the bounding box,
    according to the ``Accept'' headers specified by the calling client.}
    \replyditem{HTTP 406: If there are two many garbage tags w.r.t the
    \texttt{maxResults} parameter in the specified bounding box.}
  \end{datalist}
\end{apidata}

\subsection{Obtaining the chart areas intersecting a bounding box}

\apilocation{get}{map/ws/chartedAreas/?topLeftX=\param{topLeftX}\&\\topLeftY=\param{topLeftY}\&bottomRightX=\param{bottomRightX}\&bottomRightY=\param{bottomRightY}\&\\cb=\param{callback\_url}}
\begin{apidata}{parameters}
  \begin{datalist}
    \replyditem{\texttt{callback\_url} a pattern inserted in the KML description
    where \texttt{\{\{\{ID\}\}\}} is replaced with the entity ID.}
  \end{datalist}
\end{apidata}
\begin{apidata}{returns}
  \begin{datalist}
    \replyditem{A KML of all the charted areas intersecting the bounding box.}
  \end{datalist}
\end{apidata}

\subsection{Obtaining the chart areas in a county}

\apilocation{get}{map/ws/countySearch/chartedAreas/\\?county=\param{countyName}\&cb=\param{callback\_url}}
\begin{apidata}{parameters}
  \begin{datalist}
    \replyditem{\texttt{callback\_url} a pattern inserted in the KML description
    where \texttt{\{\{\{ID\}\}\}} is replaced with the entity ID.}
  \end{datalist}
\end{apidata}
\begin{apidata}{returns}
  \begin{datalist}
    \replyditem{A KML of all the charted areas in the county.}
  \end{datalist}
\end{apidata}

\subsection{Obtaining the garbage tags in a county}
\apilocation{get}{map/ws/countySearch/garbages/\\?county=\param{countyName}\&cb=\param{callback\_url}}
\begin{apidata}{parameters}
  \begin{datalist}
    \replyditem{\texttt{callback\_url} a pattern inserted in the KML description
    where \texttt{\{\{\{ID\}\}\}} is replaced with the entity ID.}
  \end{datalist}
\end{apidata}


\begin{apidata}{returns}
  \begin{datalist}
    \replyditem{A KML of all the garbages in the county.}
  \end{datalist}
\end{apidata}


